<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rifaz Cafe - Admin Login</title>
    <meta
      name="description"
      content="Admin login for BC Food Subscription management"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçõ</text></svg>"
    />

    <!-- Google Fonts - Outfit + Playfair Display -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css" />

    <style>
      /* Login Page Specific Styles */
      .login-page {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--space-4);
        background: linear-gradient(
          135deg,
          var(--cream) 0%,
          var(--cream-dark) 100%
        );
      }

      .login-container {
        width: 100%;
        max-width: 420px;
      }

      .login-card {
        background: var(--white);
        border-radius: var(--radius-2xl);
        box-shadow: var(--shadow-xl);
        padding: var(--space-8);
        text-align: center;
      }

      .login-logo {
        margin-bottom: var(--space-4);
        color: var(--primary);
      }

      .login-logo svg {
        width: 56px;
        height: 56px;
        stroke-width: 1.5;
      }

      .login-title {
        font-family: "Playfair Display", serif;
        font-size: var(--font-size-2xl);
        font-weight: 700;
        color: var(--neutral-900);
        margin-bottom: var(--space-2);
        letter-spacing: 0.5px;
      }

      .login-subtitle {
        color: var(--neutral-500);
        margin-bottom: var(--space-8);
      }

      .login-form {
        text-align: left;
      }

      .password-field {
        position: relative;
      }

      .password-toggle {
        position: absolute;
        right: var(--space-4);
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        font-size: var(--font-size-lg);
        color: var(--neutral-400);
        padding: var(--space-2);
      }

      .password-toggle:hover {
        color: var(--primary);
      }

      .login-error {
        background: var(--danger-light);
        color: var(--danger);
        padding: var(--space-4);
        border-radius: var(--radius-lg);
        margin-bottom: var(--space-5);
        font-size: var(--font-size-sm);
        display: none;
      }

      .login-error.show {
        display: block;
      }

      .login-success {
        background: var(--success-light);
        color: var(--success);
        padding: var(--space-4);
        border-radius: var(--radius-lg);
        margin-bottom: var(--space-5);
        font-size: var(--font-size-sm);
        display: none;
      }

      .login-success.show {
        display: block;
      }

      .login-footer {
        margin-top: var(--space-6);
        padding-top: var(--space-6);
        border-top: 1px solid var(--neutral-100);
        color: var(--neutral-500);
        font-size: var(--font-size-sm);
      }

      /* Loading state */
      .btn-loading {
        position: relative;
        pointer-events: none;
      }

      .btn-loading::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid var(--white);
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        right: var(--space-4);
      }
    </style>
  </head>
  <body>
    <div class="login-page">
      <div class="login-container">
        <div class="login-card">
          <!-- Logo -->
          <div class="login-logo"><i data-lucide="coffee"></i></div>
          <h1 class="login-title">Rifaz Cafe</h1>
          <p class="login-subtitle">Admin Panel Login</p>

          <!-- Messages -->
          <div class="login-success" id="loginSuccess"></div>
          <div class="login-error" id="loginError"></div>

          <!-- Login Form -->
          <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
            <div class="form-group">
              <label class="form-label" for="email">Email Address</label>
              <input
                type="email"
                class="form-control"
                id="email"
                placeholder="admin@example.com"
                required
                autocomplete="email"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="password">Password</label>
              <div class="password-field">
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  placeholder="Enter your password"
                  required
                  autocomplete="current-password"
                  style="padding-right: 50px"
                />
                <button
                  type="button"
                  class="password-toggle"
                  onclick="togglePassword()"
                >
                  <i data-lucide="eye" style="width: 18px; height: 18px"></i>
                </button>
              </div>
            </div>

            <button
              type="submit"
              class="btn btn-primary btn-lg btn-block"
              id="loginBtn"
            >
              Login to Admin Panel
            </button>
          </form>

          <div class="login-footer">
            <p>Secure Admin Access Only</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script>
      // Initialize auth
      document.addEventListener("DOMContentLoaded", async () => {
        await Auth.init();

        // Render Lucide Icons
        if (window.lucide) lucide.createIcons();

        // Redirect if already logged in
        Auth.redirectIfLoggedIn();

        // Show logout message if exists
        const logoutMessage = sessionStorage.getItem("bc_logout_message");
        if (logoutMessage) {
          showSuccess(logoutMessage);
          sessionStorage.removeItem("bc_logout_message");
        }
      });

      // Toggle password visibility
      function togglePassword() {
        const passwordInput = document.getElementById("password");
        const toggleBtn = document.querySelector(".password-toggle");

        if (passwordInput.type === "password") {
          passwordInput.type = "text";
          toggleBtn.innerHTML =
            '<i data-lucide="eye-off" style="width:18px;height:18px"></i>';
        } else {
          passwordInput.type = "password";
          toggleBtn.innerHTML =
            '<i data-lucide="eye" style="width:18px;height:18px"></i>';
        }
        if (window.lucide) lucide.createIcons();
      }

      // Handle login form submission
      async function handleLogin(e) {
        e.preventDefault();

        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value;
        const loginBtn = document.getElementById("loginBtn");

        // Clear messages
        hideMessages();

        // Show loading
        loginBtn.classList.add("btn-loading");
        loginBtn.disabled = true;
        loginBtn.textContent = "Logging in...";

        try {
          const result = await Auth.login(email, password);

          if (result.success) {
            showSuccess(result.message);

            // Redirect to dashboard
            setTimeout(() => {
              window.location.href = "index.html";
            }, 500);
          } else {
            showError(result.message);
          }
        } catch (error) {
          showError("An error occurred. Please try again.");
          console.error("Login error:", error);
        } finally {
          loginBtn.classList.remove("btn-loading");
          loginBtn.disabled = false;
          loginBtn.textContent = "Login to Admin Panel";
        }
      }

      // Show error message
      function showError(message) {
        const errorEl = document.getElementById("loginError");
        errorEl.textContent = "‚ùå " + message;
        errorEl.classList.add("show");
      }

      // Show success message
      function showSuccess(message) {
        const successEl = document.getElementById("loginSuccess");
        successEl.textContent = "‚úì " + message;
        successEl.classList.add("show");
      }

      // Hide all messages
      function hideMessages() {
        document.getElementById("loginError").classList.remove("show");
        document.getElementById("loginSuccess").classList.remove("show");
      }
    </script>
  </body>
</html>
